<!DOCTYPE HTML>
<html lang="en" class="light" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Using a Virtual Environment - Grants Pass GIS Documentation</title>


        <!-- Custom HTML head -->
        
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->

    </head>
    <body class="sidebar-visible no-js">
    <div id="body-container">
        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('light')
            html.classList.add(theme);
            var body = document.querySelector('body');
            body.classList.remove('no-js')
            body.classList.add('js');
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var body = document.querySelector('body');
            var sidebar = null;
            var sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            body.classList.remove('sidebar-visible');
            body.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded "><a href="overview.html"><strong aria-hidden="true">1.</strong> Home</a></li><li class="chapter-item expanded "><a href="addressing.html"><strong aria-hidden="true">2.</strong> Addressing Manual</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="address_request.html"><strong aria-hidden="true">2.1.</strong> The Address Request Form</a></li><li class="chapter-item expanded "><a href="addressing_layer.html"><strong aria-hidden="true">2.2.</strong> The Addressing Layer</a></li><li class="chapter-item expanded "><a href="addressing_rules.html"><strong aria-hidden="true">2.3.</strong> Addressing Rules</a></li><li class="chapter-item expanded "><a href="addressing_policies.html"><strong aria-hidden="true">2.4.</strong> Addressing Policies</a></li><li class="chapter-item expanded "><a href="address_verification.html"><strong aria-hidden="true">2.5.</strong> Address Verification</a></li><li class="chapter-item expanded "><a href="address_strategic_plan.html"><strong aria-hidden="true">2.6.</strong> Address Strategic Plan</a></li><li class="chapter-item expanded "><a href="lexisnexis.html"><strong aria-hidden="true">2.7.</strong> LexisNexis Tables</a></li></ol></li><li class="chapter-item expanded "><a href="publishing_services.html"><strong aria-hidden="true">3.</strong> Services</a></li><li class="chapter-item expanded "><a href="layer_files.html"><strong aria-hidden="true">4.</strong> Layer Files</a></li><li class="chapter-item expanded "><a href="survey_points.html"><strong aria-hidden="true">5.</strong> Survey Points</a></li><li class="chapter-item expanded "><a href="packages_intro.html"><strong aria-hidden="true">6.</strong> Packages</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="github.html"><strong aria-hidden="true">6.1.</strong> Github Integration</a></li><li class="chapter-item expanded "><a href="using_git.html"><strong aria-hidden="true">6.2.</strong> Using git</a></li><li class="chapter-item expanded "><a href="git_workflow.html"><strong aria-hidden="true">6.3.</strong> Git Workflow</a></li><li class="chapter-item expanded "><a href="virtual_env.html" class="active"><strong aria-hidden="true">6.4.</strong> Using a Virtual Environment</a></li><li class="chapter-item expanded "><a href="web_services_update.html"><strong aria-hidden="true">6.5.</strong> Updating Web Services</a></li></ol></li><li class="chapter-item expanded "><a href="utility_editing.html"><strong aria-hidden="true">7.</strong> Utility Editing</a></li><li class="chapter-item expanded "><a href="utility_network_creation.html"><strong aria-hidden="true">8.</strong> Utility Network Creation</a></li><li class="chapter-item expanded "><a href="scripts_intro.html"><strong aria-hidden="true">9.</strong> Stand-Alone Scripts</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="missing_sidewalks.html"><strong aria-hidden="true">9.1.</strong> Missing Sidewalks</a></li></ol></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <!-- Track and set sidebar scroll position -->
        <script>
            var sidebarScrollbox = document.querySelector('#sidebar .sidebar-scrollbox');
            sidebarScrollbox.addEventListener('click', function(e) {
                if (e.target.tagName === 'A') {
                    sessionStorage.setItem('sidebar-scroll', sidebarScrollbox.scrollTop);
                }
            }, { passive: true });
            var sidebarScrollTop = sessionStorage.getItem('sidebar-scroll');
            sessionStorage.removeItem('sidebar-scroll');
            if (sidebarScrollTop) {
                // preserve sidebar scroll position when navigating via links within sidebar
                sidebarScrollbox.scrollTop = sidebarScrollTop;
            } else {
                // scroll sidebar to current active section when navigating via "next/previous chapter" buttons
                var activeSection = document.querySelector('#sidebar .active');
                if (activeSection) {
                    activeSection.scrollIntoView({ block: 'center' });
                }
            }
        </script>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Grants Pass GIS Documentation</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="using-a-virtual-environment"><a class="header" href="#using-a-virtual-environment">Using a Virtual Environment</a></h1>
<p>Virtual environments are a common tool in Python development for dependency management.<br />
The developer community uses a plethora of user-defined packages to provide functionality and options that extend beyond those in the standard library.<br />
By default Python installs these third-party libraries into the same site-packages directory.<br />
As summarized in <a href="https://realpython.com/python-virtual-environments-a-primer/">Python Virtual Environments: A Primer</a>, installing all third-party packages into a common directory can lead to the following issues:</p>
<ul>
<li>Reproducibility
<ul>
<li>A package may require specific versions of support libraries to run, and the same combination of libraries installed with different versions on a new machine may be unable to run the package.</li>
</ul>
</li>
<li>System Pollution
<ul>
<li>Linux and MacOS systems come with a version of Python pre-installed, and third-party packages can cause unexpected side-effects on the operating system's normal behavior.</li>
</ul>
</li>
<li>Dependency Conflicts
<ul>
<li>Packages installed for unrelated projects can rely on different versions of third-party packages as dependencies. There may not be a single version of the required library that can support and run both packages, creating a dependency conflict.</li>
</ul>
</li>
</ul>
<p>The <code>arcgis</code> package for Python caused a particularly problematic system pollution problem for me at my previous job in county government.
I had tried and failed to install the package on my machine, where the error message informed me there was a problem with the <code>ca-certificates</code> package.
The problem is that the system used <code>ca-certificates</code> to perform any and all Python operations, and this package had become corrupted by my attempted install of <code>arcgis</code>.
I could no longer use Python at all on this machine.
I did not have administrative privileges to install programs on this machine, and so IT had to send staff over to my building to help me uninstall and reinstall Python, which did not resolve the issue, much to our surprise.
At the county, our IT staff did not have experience developing in Python, and the situation is no different here at Grants Pass.
I ended up having to switch to a different (and less performant) machine.
With a virtual environment, the problem is contained to the virtual environment, so when I encountered this problem again on my new machine (and I did), I could simply delete the corrupted environment and start again.
Take a lesson from my hard-earned experience and use virtual environments for Python development like you would a crash helmet on a motorcycle.</p>
<h2 id="creating-a-virtual-environment"><a class="header" href="#creating-a-virtual-environment">Creating a Virtual Environment</a></h2>
<p>The use of virtual environments in Python is so ubiquitous that Python now includes virtual environment support in its standard library through the <code>venv</code> package. While there are third-party libraries such as <code>virtualenv</code> and <code>conda</code> that can create virtual environments, and may be desirable for certain use applications, we recommend using the built-in support of the <code>venv</code> package, and this is the method we have used in developing the Python packages in the Grants Pass code repository.</p>
<p>The command to create a virtual environment from the command-line prompt is:</p>
<pre><code class="language-{bash}">python -m venv {name}
</code></pre>
<p>Substitute {name} for the desired name of the virtual environment. For example, I have a generic test environment on my machine creatively named 'test':</p>
<pre><code class="language-{bash}">python -m venv test
</code></pre>
<p>I could also name the environment after a specific project or my job title:</p>
<pre><code class="language-{bash}">python -m venv my_project
python -m venv technician
</code></pre>
<p>If you wish to overwrite an old virtual environment (deleting any packages installed into it), add the flag '--clear':</p>
<pre><code class="language-{bash}">python -m venv test --clear
</code></pre>
<p>The computer stores the information related to the virtual environment in an eponymous folder located in the working directory. Some users prefer to create the virtual environment in the working directory of specific projects, while other users prefer to create a dedicated folder for various virtual environments. You can delete a virtual environment from your system by deleting this folder.</p>
<p>Note that the system path needs to include the location of the Python executable for these commands to work on your machine.
When installing Python, you can check the box to automatically add the Python executable to your system path, or you can manually add it by modifying the path in the system environmental variables.
On a Windows machine, you can type the Windows key and enter 'environmental variables' into the search bar, and select 'Edit the system environmental variables' from the Control Panel.
Select the 'path' variable and click on 'Edit'.
Unless you have specified a different installation directory, the path to the Python executable should be 'C:/Users/username/AppData/Local/Programs/Python/Python310/'.
On my machine the path looks like this: 'C:\Users\erose\AppData\Local\Programs\Python\Python310'.
If the Python executable is not in your system path, you can create a virtual environment by specifying the path manually, so on my machine I could enter:</p>
<pre><code class="language-{bash}">C:\Users\erose\AppData\Local\Programs\Python\Python310\python -m venv test
</code></pre>
<h2 id="activating-the-virtual-environment"><a class="header" href="#activating-the-virtual-environment">Activating the Virtual Environment</a></h2>
<p>You can create multiple virtual environments on your machine, but before you begin installing packages, you have to direct the processor to spool up the virtual environment that you want to use.
Inside the folder named after your environment, there is a sub-folder called <code>Scripts</code> that contain a number of executables, and a pair of files called <code>activate</code> and <code>deactivate</code>.
To start up a virtual environment, you call the activate script.
If your working directory contains the virtual environment folder, you can use the relative path to call this script, using the command:</p>
<pre><code class="language-{bash}">{name}/Scripts/activate
</code></pre>
<p>So if the virtual environment is called 'test', and your working directory contains the folder 'test' where the virtual environment is stored on your machine, then you can run the command:</p>
<pre><code class="language-{bash}">test/Scripts/activate
</code></pre>
<p>I keep my repository code in a 'repos' folder, and my virtual environments in an 'envs' folder, so I can activate the environment from my home directory and navigate to the repo of interest:</p>
<pre><code class="language-{bash}">cd c:/users/erose
envs/test/Scripts/activate
cd repos/webmap
</code></pre>
<p>Or I can activate the environment from within the code directory using a relative path:</p>
<pre><code class="language-{bash}">cd c:/users/erose/repos/webmap
../../envs/test/Scripts/activate
</code></pre>
<p>Declaring the full path does not work on my Windows machine from Powershell. I could not say why.</p>
<pre><code class="language-{bash}"># does not work
cd p:/repos/webmap
c:/users/erose/envs/test/Scripts/activate
</code></pre>
<p>Note that many online tutorials will direct you to use the <code>source</code> keyword to call the activation script, but this only applies to Linux and MacOS development environments. Using Powershell on Windows, this will not work:</p>
<pre><code class="language-{bash}"># does not work
cd c:/users/erose/envs
source test/Scripts/activate
</code></pre>
<p>Calling <code>source</code> on Windows in Powershell produces the following error: <em>"The term 'source' is not recognized as the name of a cmdlet, function, script file, or operable program. Check the spelling of the name, or if a path was included, verify that the path is correct and try again."</em></p>
<p>When the virtual environment is active, the name of the environment will appear in parenthesis before the <code>PS</code> in the prompt:</p>
<pre><code class="language-{bash}"># virtual environment not active
PS c:\&gt; cd c:/users/erose/envs
PS c:\users\erose\envs&gt; test/Scripts/activate
# virtual environment active
(test) PS c:\users\erose\envs&gt;
</code></pre>
<p>To leave the virtual environment, you can call the deactivate script:</p>
<pre><code class="language-{bash}">{name}/Scripts/deactivate
</code></pre>
<p>Using the previous example:</p>
<pre><code class="language-{bash}"># virtual environment active
(test) PS c:\users\erose\envs&gt; test/Scripts/deactivate
# virtual environment not active
PS c:\users\erose\envs&gt;
</code></pre>
<p>The virtual environment will also deactivate if you close the terminal, stopping the running instance of Powershell. So feel free to simply exit or shutdown when you are done.</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="git_workflow.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="web_services_update.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="git_workflow.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="web_services_update.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="elasticlunr.min.js"></script>
        <script src="mark.min.js"></script>
        <script src="searcher.js"></script>

        <script src="clipboard.min.js"></script>
        <script src="highlight.js"></script>
        <script src="book.js"></script>

        <!-- Custom JS scripts -->


    </div>
    </body>
</html>
